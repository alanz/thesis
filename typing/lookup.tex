\begin{figure}

\fbox{\textbf{Type lookup:} $\ctx \vdash M : T$}

\[
\frac{
p : \Xi \in \Gamma \qquad
m : T^+ \in \Xi \qquad
\Gamma; \Delta; P_0 \vdash \textsf{rename}_S~ T \leadsto T'
}{
\Gamma; \Delta; P_0 \vdash \Mod{p[S]}{m} : T'
}
\quad(\textsc{TUnit})
\]

\begin{twocol}
\[
\frac{
m : T^- \in \Delta
}{
\Gamma; \Delta; P_0 \vdash \hv{m} : T
}
\quad(\textsc{THole})
\]
&
\[
\frac{
m : T^+ \in \Delta
}{
\Gamma; \Delta; P_0 \vdash \Mod{P_0}{m} : T
}
\quad(\textsc{TMod})
\]
\end{twocol}

\fbox{\textbf{Signature type lookup:} $\ctx \vdash M :_\textsf{sig} T$}

\[
\frac{
\begin{array}{c}
% Look up each signature
p : \Xi \in \Gamma \qquad
m : T^- \in \Xi \qquad
% And do the provisional renaming (without assuming m in Delta)
\Gamma; \Delta; P_0 \vdash \textsf{renamesig}_{m,S}~ T \leadsto T' \\
\end{array}
}{
\Gamma; \Delta; P_0 \vdash \Mod{p[S]}{m} :_\textsf{sig} T' \\
}
\quad(\textsc{TUnitSig})
\]

\caption{Type lookup rules}
\end{figure}
