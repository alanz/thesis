
\begin{figure}

\textsf{rename} is functorial on interface.  Key case is handling name.

\fbox{$\ctx \vdash \textsf{rename}_S~ N \leadsto N$}

\begin{itemize}

\item
Ordinary names just have substitution applied to them.

\[
\ctx \vdash \textsf{rename}_S~ M.n \leadsto M[S].n
\]

\item
A hole name must be substituted by consulting the exports
of the module substituted in.  (This assumes that the export
list is sufficient, which it will be if we checked if the
substitution matches.)

\[
\frac{
\ctx \vdash S(m) : T \qquad
T ~\textsf{exports}~ \UNs
}{
\ctx \vdash \textsf{rename}_S~ \nhv{m.n} \leadsto \UNs(n)
}
\]

\end{itemize}

Renaming signatures which are not in $\Delta$ (in $\ctx$).  Functorial on types.  Otherwise defers to usual renaming.

\fbox{$\ctx \vdash \textsf{renamesig}_{m,S}~ T \leadsto T$}
\fbox{$\ctx \vdash \textsf{renamesig}_{m,S}~ N \leadsto N$}

\[
\frac{
S(m) = \hv{m'}
}{
\ctx \vdash \textsf{renamesig}_{m,S}~ \nhv{m.n} \leadsto \nhv{m'.n} \\
}
\]

\[
\frac{
N ~\textsf{names}~ n \qquad
N \neq \nhv{m.n} \qquad
\ctx \vdash \textsf{rename}_S~ N \leadsto N' \
}{
\ctx \vdash \textsf{renamesig}_{m,S}~ N \leadsto N' \\
}
\]

\caption{Renaming}

\end{figure}
